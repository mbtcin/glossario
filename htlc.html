<!doctype html>
<html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>HTLC Hash Timelock Contracts  - Glossario Bitcoin</title><link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet"/><link href="bootstrap-5.2.0-dist/css/bootstrap.min.css" rel="stylesheet"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/4.1.5/css/flag-icons.min.css" integrity="sha512-UwbBNAFoECXUPeDhlKR3zzWU3j8ddKIQQsDOsKhXQGdiB5i3IHEXr9kXx82+gaHigbNKbTDp3VY/G6gZqva6ZQ==" crossorigin="anonymous" referrerpolicy="no-referrer"/></head><body><div><header style="background: #ff9300;"><header class="p-4 bg-white flex flex-col lg:flex-row justify-between items-center"><div><a href="https://bitcoinitalianetwork.com/" class="text-lg"><span class="font-bold text-black"><span class="bg-green-500">&nbsp;₿itcoin</span><span>Italia</span><span class="bg-red-500 text-white">Network&nbsp;</span></span></a></div></header></header><div class="container"><nav><ol class="breadcrumb"><li class="breadcrumb-item"><a href="https://bitcoinitalianetwork.com/">Home</a></li><li class="breadcrumb-item"><a href="https://glossario.bitcoinitalianetwork.com/">Glossario</a></li><li class="breadcrumb-item"><a href="livello_avanzato.html">avanzato</a></li><li class="breadcrumb-item"><a href="avanzato_tecnologia.html">tecnologia</a></li></ol></nav></div><main><div class="container"><div class="card"><div class="card-body"><h5 class="card-body"><div><p><span class="flag-icon flag-icon-gb"></span><span> </span>HTLC</p><p class="fs-6"><span class="text-secondary">acronimo di: </span>Hash Timelock Contracts</p><div></div></div></h5><p class="card-text"><div><p><span class="text-secondary">Difficoltà: </span><a href="livello_avanzato.html" class="badge bg-primary">avanzato</a></p><p><span class="text-secondary">Argomento: </span><span class="badge rounded-pill bg-success">tecnologia</span></p><hr/><p class="fw-bold">DEFINIZIONE</p><section><p class="fs-5"><p>Un HTLC è un pagamento condizionale dal mittente al destinatario. Può essere speso immediatamente dal destinatario rivelando un certo codice segreto, oppure può essere reclamato dal mittente dopo un certo periodo di timeout.</p>
<p>Alla base di questo funzionamento c'è un concetto di base: il destinatario del pagamento può spenderlo subito attraverso una transazione valida, mentre la restituzione dell'importo al mittente è una forma di protezione per il mittente laddove il destinatario non pubblichi una transazione valida.</p>
<p>È quindi un pagamento temporizzato: il ricevente per incassarlo deve presentare un codice segreto, ma se non lo fa entro un certo tempo, il pagamento torna indietro a chi lo ha emesso.</p>
<p>È una funzione per creare <a href="smart-contract.html">smart contract</a>, il cui uso più popolare è il <a href="lightning-network.html">Lightning Network</a> di Bitcoin, e più recentemente <a href="defi.html">DeFI</a> attraverso l’uso di <a href="atomic-swap.html">atomic swap</a> sia sulla stessa chain che cross-chain, zero-knowledge contingent payment, and e altri protocolli di smart contract.
Sono smart contract che facilitano le transazioni di scambio atomico, e funzionano come una "cassaforte virtuale" che richiede una chiave HashLock e <a href="timelocklocktime.html">TimeLock</a> per sbloccare i fondi durante uno scambio.</p>
<p>HTLC è l'acronimo di "Hash Time-Locked Contract" (contratto bloccato da <a href="hash.html">hash</a> e temporale), ed è un tipo di smart contract utilizzato sulla rete Lightning per consentire il trasferimento di fondi tra due parti in modo sicuro e affidabile. Un HTLC stabilisce una condizione per il trasferimento di fondi, ad esempio il <a href="liquidity-provider.html">fornitore di liquidità</a> deve fornire un hash di una password nota solo a lui, e il ricevente deve fornire la password corrispondente per ricevere i fondi. In questo modo, entrambe le parti hanno la certezza che l'altra parte ha rispettato i termini del contratto. Gli HTLC sono molto utili sulla rete Lightning perché consentono di eseguire transazioni in modo rapido e sicuro, permettendo ai partecipanti alla rete di fidarsi l'uno dell'altro senza dover passare attraverso intermediari centralizzati.</p>
<p>La funzione HTLC consente l'implementazione di transazioni vincolate a tempo tra due utenti: il destinatario di una transazione HTLC deve riconoscere il pagamento presentando una prova crittografica entro un periodo di tempo specificato (o più precisamente entro un numero di blocchi). Se il destinatario rinuncia o non richiede il pagamento, i fondi verranno restituiti al mittente originale.
La funzionalità HTLC viene applicata nei canali di pagamento sia bidirezionali che instradati per consentire trasferimenti sicuri di fondi su vari canali, senza che sia necessario riporre fiducia su nessuno degli intermediari.</p>
<p>Le due componenti, o clausole, principali di un HTLC sono:</p>
<ul>
<li>una clausola di pagamento assicurata con un hashlock</li>
<li>e una clausola di rimborso assicurata con un timelock.</li>
</ul>
<p>La chiave hashlock assicura che la transazione vada a buon fine solo quando entrambe le parti forniscono una prova crittografica mentre la funzione timelock assicura che una scadenza possa essere impostata e rispettata per il completamento della transazione.
Per aprire un hashlock e richiedere un pagamento, il destinatario deve rivelare la <a href="preimage.html">preimage</a> di un <a href="digest.html">digest</a> di hash codificato nello smart contract. Per sbloccare un timelock e ricevere un rimborso, chi spende deve aspettare fino a un certo tempo codificato nello smart contract.
Poiché le preimage rivelate e il tempo trascorso non identificano in modo univoco la persona che dovrebbe ricevere il pagamento, gli HTLC sono sicuri solo se richiedono anche una firma unica che corrisponda alla chiave pubblica di chi spende (refundee) o del destinatario. </p>
<p>L'utilizzo sulla rete Lightning consente ai pagamenti Lightning di essere instradati attraverso più nodi. L'instradamento Lightning permette a due parti di effettuare transazioni in modo trustless senza un canale diretto tra loro, utilizzando invece canali intermediari.</p>
<p>I <a href="ptlc.html">PTLC</a> svolgono la stessa funzione degli HTLC ma possono fornire una migliore privacy, usare meno spazio a blocchi e prevenire l'intercettazione del <a href="routing.html">routing</a>, anche se hanno degli aspetti negativi.</p>
<p>Questo il codice script di un HTLC</p>
<pre><code># al destinario via LN penalty
OP_DUP OP_HASH160 &lt;RIPEMD160(SHA256(revocationpubkey))&gt; OP_EQUAL
OP_IF
    OP_CHECKSIG
OP_ELSE
    &lt;receiver_htlcpubkey&gt; OP_SWAP OP_SIZE 32 OP_EQUAL
        OP_NOTIF
            # al mittente via HTLC-timeout transaction (timelocked).
            OP_DROP 2 OP_SWAP &lt;sender_htlcpubkey&gt; 2 OP_CHECKMULTISIG
        OP_ELSE
            # al destinatario con preimage
            OP_HASH160 &lt;RIPEMD160 (payment_hash)&gt; OP_EQUALVERIFY
            OP_CHECKSIG
        OP_ENDIF
OP_ENDIF
</code></pre></p></section><div><ul class="list-group  list-group-flush"><li class="list-group-item fw-bold">Link utili:</li><li class="list-group-item"><a href="https://bitcoinops.org/en/topics/htlc/">Hash Time Locked Contract (HTLC) sul sito Bitcoin Optech, Operations Technology, Group (in inglese)</a></li><li class="list-group-item"><a href="https://lightning.engineering/posts/2023-06-28-channel-normal-op">A Technical Walkthrough of HTLC and Lightning Channel Operations (in inglese)</a></li><li class="list-group-item"><a href="https://mempool.space/tx/4ec0f703e08e2babfbff9da597c6f3710332f29a4bc7175d0e89e8f681f4634a">Una transazione HTLC</a></li></ul></div><div class="row p-4 fw-light"><ul class="list-group"><li class="list-group-item list-group-item-primary">Vedi anche</li><li class="list-group-item list-group-item-action"><a href="amp.html">AMP</a> (Atomic Multipath Payment) Pagamento multipercorso atomico</li><li class="list-group-item list-group-item-action"><a href="atomic-swap.html">Atomic Swap</a></li><li class="list-group-item list-group-item-action"><a href="block-height.html">Block height</a> Altezza del blocco</li><li class="list-group-item list-group-item-action"><a href="defi.html">DeFi</a> (Decentralized Finance) finanza decentralizzata</li><li class="list-group-item list-group-item-action"><a href="hold-invoice.html">Hold Invoice</a></li><li class="list-group-item list-group-item-action"><a href="lightning-network.html">Lightning Network</a></li><li class="list-group-item list-group-item-action"><a href="preimage.html">preimage</a></li><li class="list-group-item list-group-item-action"><a href="ptlc.html">PTLC</a> (Point Time Locked Contracts)</li><li class="list-group-item list-group-item-action"><a href="smart-contract.html">Smart Contract</a></li><li class="list-group-item list-group-item-action"><a href="timelocklocktime.html">Timelock/Locktime</a></li></ul></div><hr/><p class="text-end fw-lighter"><span class="text-secondary">aggiornato il </span>2022-03-15</p></div></p></div></div></div></main><div class="container-fluid text-white bg-dark"><div class="container"><footer class="py-5"><div class="row"><div>Scarica il glossario: 
<a href="glossario.pdf" class="text-white">pdf</a> 
<a href="glossario.epub" class="text-white">epub</a></div><div class="row fs-6 fw-lighter">il Glossario Bitcoin in italiano è disponibile su ipfs: <ul><li><span><a href="https://shrill-water-3846.on.fleek.co/" class="text-white">tramite Fleek</a> <a href="https://docs.ipfs.io/how-to/websites-on-ipfs/introducing-fleek/" class="text-white">(cos'è Fleek?)</a></span></li></ul></div></div><div class="d-flex justify-content-between py-4 my-4 border-top"><a href="https://BitcoinItaliaNetwork.com" style="color: white;">Bitcoin Italia Network</a><a href="https://nostree.me/npub14yzptn3vkf4ravfl9dhu49pzqpsap3m5emze2e6v4tuyceht72eqkhzldt" style="color: white;">21 Milioni di chiacchiere</a><ul class="list-unstyled d-flex"><li class="ms-3"><a href="https://t.me/+iCd-GTx2Sx04Mzk0" class="text-white"><i class="bi bi-telegram"></i></a></li><li class="ms-3"><a href="https://twitter.com/21MdiC_BTC" class="text-white"><i class="bi bi-twitter-x"></i></a></li><li class="ms-3"><a href="https://www.facebook.com/groups/1479005739604711" class="text-white"><i class="bi bi-facebook"></i></a></li><li class="ms-3"><a href="https://nostr.com/npub14yzptn3vkf4ravfl9dhu49pzqpsap3m5emze2e6v4tuyceht72eqkhzldt" class="text-white"><i class="bi bi-clipboard2-check"></i></a></li><li class="ms-3"><a href="https://www.threads.net/@21mdic.btc" class="text-white"><i class="bi bi-threads"></i></a></li></ul></div></footer></div></div></div><script src="bootstrap-5.2.0-dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script></body></html>