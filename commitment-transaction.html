<!doctype html>
<html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>commitment transaction transazione di impegno  - Glossario Bitcoin</title><link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet"/><link href="bootstrap-5.2.0-dist/css/bootstrap.min.css" rel="stylesheet"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/4.1.5/css/flag-icons.min.css" integrity="sha512-UwbBNAFoECXUPeDhlKR3zzWU3j8ddKIQQsDOsKhXQGdiB5i3IHEXr9kXx82+gaHigbNKbTDp3VY/G6gZqva6ZQ==" crossorigin="anonymous" referrerpolicy="no-referrer"/></head><body><div><header style="background: #ff9300;"><header class="p-4 bg-white flex flex-col lg:flex-row justify-between items-center"><div><a href="https://bitcoinitalianetwork.com/" class="text-lg"><span class="font-bold text-black"><span class="bg-green-500">&nbsp;₿itcoin</span><span>Italia</span><span class="bg-red-500 text-white">Network&nbsp;</span></span></a></div></header></header><div class="container"><nav><ol class="breadcrumb"><li class="breadcrumb-item"><a href="https://bitcoinitalianetwork.com/">Home</a></li><li class="breadcrumb-item"><a href="https://glossario.bitcoinitalianetwork.com/">Glossario</a></li><li class="breadcrumb-item"><a href="livello_avanzato.html">avanzato</a></li><li class="breadcrumb-item"><a href="avanzato_tecnologia.html">tecnologia</a></li></ol></nav></div><main><div class="container"><div class="card"><div class="card-body"><h5 class="card-body"><div><p><span class="flag-icon flag-icon-gb"></span><span> </span>commitment transaction</p><p><span class="flag-icon flag-icon-it"></span><span> </span>transazione di impegno</p></div></h5><p class="card-text"><div><p><span class="text-secondary">Difficoltà: </span><a href="livello_avanzato.html" class="badge bg-primary">avanzato</a></p><p><span class="text-secondary">Argomento: </span><span class="badge rounded-pill bg-success">tecnologia</span></p><hr/><p class="fw-bold">DEFINIZIONE</p><section><p class="fs-5"><p>Una commitment transaction, in italiano traducibile in transazione di impegno, è una transazione Bitcoin firmata da entrambi i partner di un <a href="lightning-channel.html">canale Lightning Network</a>, che rappresenta l'ultimo saldo del canale, che viene scambiata tra i partnon e viene immediatamente salvata sulla blockchain <a href="on-chain.html">on-chain</a>.</p>
<p>Ogni volta che viene effettuato o inoltrato un nuovo pagamento utilizzando il canale Lightning, il saldo del canale si aggiorna e viene firmata una nuova commitment transaction con due output spendibili, uno per ogni partner.  </p>
<p>Le commitment transaction garantiscono che non sia necessario fidarsi del proprio partner del canale per recuperare il balance del canale in caso di problemi.</p>
<p>Nel caso di un canale tra Alice e Bob, entrambi i partecipanti mantengono una copia della commitment transaction firmata da entrambi.<br />
La chiusura normale di un canale viene effettuata tramite una <a href="closing-transaction.html">closing transaction</a> firmata in accordo da entrambi i partner. Tuttavia, sia Alice che Bob possono unilateralmente chiudere il canale in qualsiasi momento inviando una commitment transaction alla blockchain Bitcoin.
La rete non è in grado di distinguere se la commitment transaction trasmessa sia la più recente o una più vecchia, ma l'invio di una versione più vecchia e quindi obsoleta della transazione è considerato un comportamento scorretto e può essere sanzionato dall'altro partner attraverso una <a href="penalty-transaction.html">penalty transaction</a> o transazione di penalità, che gli permette di rivendicare tutti i fondi del canale per sé.</p>
<h4>Spesa ritardata (Timelocked) verso se stessi</h4>
<p>Le commitment transaction sono asimmetriche nel modo in cui gestiscono i fondi in caso di chiusura forzata di un canale Lightning. Se una delle parti tenta di chiudere il canale trasmettendo una vecchia versione della transazione, il partner onesto ha la possibilità di contestare questa azione. In questo scenario:</p>
<ul>
<li>I fondi del partner che ha avviato la chiusura forzata (e che ha tentato di trasmettere una transazione obsoleta) vengono indirizzati verso un contratto di arbitrato. Questo contratto impone un periodo di attesa, permettendo al partner onesto di presentare una prova di illecito.</li>
<li>I fondi del partner onesto vengono invece inviati immediatamente al suo wallet.</li>
</ul>
<p>Questa asimmetria concede al partner onesto il tempo necessario per confutare la transazione illecita e rivendicare i propri fondi, fornendo così un meccanismo di sicurezza contro comportamenti fraudolenti.  </p>
<p>Le <a href="fee.html">fee</a> della commitment transaction vengono impostate durante la negoziazione della transazione, e non possono essere modificate senza entrambe le firme; poiché non si possono conoscere quali saranno le fee in futuro per consentire di confermare la transazione in tempo, possono essere impostate con un importo significativamente più alto, fino a cinque volte, rispetto alle stime al momento della negoziazione.</p>
<p>La commitment transaction include output aggiuntivi per eventuali <a href="htlc.html">HTLC</a> in sospeso, rendendola più grande in termini di byte rispetto a una closing transaction di chiusura reciproca.<br />
Di solito questo non sarebbe troppo grave.<br />
Ma se c'è un congestionamento della rete, con molti HTLC in attesa che devono essere inclusi nella transazione, la transazione può avere delle dimensioni tali che con un mercato di fee molto alto potrebbero portare ad avere delle fee superiori all'intero balance del canale.</p>
<p>I due output sono chiamati:</p>
<ul>
<li>to_local </li>
<li>to_remote </li>
</ul>
<p>Questo il codice script del primo output (to_local) di una commitment transaction:</p>
<pre><code>OP_IF
    # Penalty transaction
    &lt;revocationpubkey&gt;
OP_ELSE
    `to_self_delay`
    OP_CHECKSEQUENCEVERIFY
    OP_DROP
    &lt;local_delayedpubkey&gt;
OP_ENDIF
OP_CHECKSIG
</code></pre>
<p>Questo script ha 2 condizioni, e l'importo può essere speso se viene soddisfatta una delle due possibili condizioni:</p>
<ul>
<li>firmare la <em>revocationpubkey</em></li>
<li>firmare la <em>local_delayedpubkey</em> dopo un numero di blocchi specificati in <em>to_self_delay</em></li>
</ul></p></section><div class="row p-4 fw-light"><ul class="list-group"><li class="list-group-item list-group-item-primary">Vedi anche</li><li class="list-group-item list-group-item-action"><a href="closing-transaction.html">closing transaction</a></li><li class="list-group-item list-group-item-action"><a href="commitment.html">commitment</a></li><li class="list-group-item list-group-item-action"><a href="force-close.html">force close</a> chiusura forzata</li><li class="list-group-item list-group-item-action"><a href="funding-transaction.html">Funding Transaction</a></li><li class="list-group-item list-group-item-action"><a href="lightning-channel.html">Lightning Channel</a> Canale Lightning</li><li class="list-group-item list-group-item-action"><a href="lightning-network.html">Lightning Network</a></li><li class="list-group-item list-group-item-action"><a href="penalty-transaction.html">penalty transaction</a></li><li class="list-group-item list-group-item-action"><a href="tx.html">TX</a> (Transaction) Transazione</li></ul></div><hr/><p class="text-end fw-lighter"><span class="text-secondary">aggiornato il </span>2025-03-27</p></div></p></div></div></div></main><div class="container-fluid text-white bg-dark"><div class="container"><footer class="py-5"><div class="row"><div>Scarica il glossario: 
<a href="glossario.pdf" class="text-white">pdf</a> 
<a href="glossario.epub" class="text-white">epub</a></div><div class="row fs-6 fw-lighter">il Glossario Bitcoin in italiano è disponibile su ipfs: <ul><li><span><a href="https://shrill-water-3846.on.fleek.co/" class="text-white">tramite Fleek</a> <a href="https://docs.ipfs.io/how-to/websites-on-ipfs/introducing-fleek/" class="text-white">(cos'è Fleek?)</a></span></li></ul></div></div><div class="d-flex justify-content-between py-4 my-4 border-top"><a href="https://BitcoinItaliaNetwork.com" style="color: white;">Bitcoin Italia Network</a><a href="https://nostree.me/npub14yzptn3vkf4ravfl9dhu49pzqpsap3m5emze2e6v4tuyceht72eqkhzldt" style="color: white;">21 Milioni di chiacchiere</a><ul class="list-unstyled d-flex"><li class="ms-3"><a href="https://t.me/+iCd-GTx2Sx04Mzk0" class="text-white"><i class="bi bi-telegram"></i></a></li><li class="ms-3"><a href="https://twitter.com/21MdiC_BTC" class="text-white"><i class="bi bi-twitter-x"></i></a></li><li class="ms-3"><a href="https://www.facebook.com/groups/1479005739604711" class="text-white"><i class="bi bi-facebook"></i></a></li><li class="ms-3"><a href="https://nostr.com/npub14yzptn3vkf4ravfl9dhu49pzqpsap3m5emze2e6v4tuyceht72eqkhzldt" class="text-white"><i class="bi bi-clipboard2-check"></i></a></li><li class="ms-3"><a href="https://www.threads.net/@21mdic.btc" class="text-white"><i class="bi bi-threads"></i></a></li></ul></div></footer></div></div></div><script src="bootstrap-5.2.0-dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script></body></html>